---
layout: correo
title: Anuncio de Rust 1.56.0 y Rust 2021
author: El equipo de liberación de óxido
release: cierto
---

El equipo de Rust se complace en anunciar una nueva versión de Rust, 1.56.0. Esto también estabiliza la edición de 2021. Rust es un lenguaje de programación que permite a todos crear software confiable y eficiente.

Si tiene una versión anterior de Rust instalada a través de rustup, obtener Rust 1.56.0 es tan fácil como:

```console
rustup update stable
```

Si aún no lo tiene, puede [obtener `rustup`] en la página correspondiente de nuestro sitio web y consultar las [notas detalladas de la versión 1.56.0] en GitHub.

## ¿Qué hay en 1.56.0 estable?

### óxido 2021

Escribimos sobre los planes para la edición Rust 2021 [en mayo](https://blog.rust-lang.org/2021/05/11/edition-2021.html) . Las ediciones son un mecanismo para optar por cambios que, de otro modo, podrían representar un riesgo de compatibilidad con versiones anteriores. Consulte [la guía de edición](https://doc.rust-lang.org/stable/edition-guide/editions/index.html) para obtener detalles sobre cómo se logra esto. Esta es una edición más pequeña, especialmente en comparación con 2018, pero todavía hay algunos cambios agradables en la calidad de vida que requieren una suscripción de edición para evitar romper algunos casos de esquina en el código existente. Consulte los nuevos capítulos de la guía de edición a continuación para obtener más detalles sobre cada nueva función y orientación para la migración.

- [Captura disjunta](https://doc.rust-lang.org/edition-guide/rust-2021/disjoint-capture-in-closures.html) : los cierres ahora capturan campos con nombre individuales en lugar de capturar siempre identificadores completos.
- [`IntoIterator` para matrices](https://doc.rust-lang.org/edition-guide/rust-2021/IntoIterator-for-arrays.html) : `array.into_iter()` ahora itera sobre elementos por valor en lugar de por referencia.
- [O los patrones en las macro-reglas](https://doc.rust-lang.org/edition-guide/rust-2021/or-patterns-macro-rules.html) ahora coinciden con el nivel superior `A|B` en `:pat` .
- [El solucionador de funciones de carga predeterminado](https://doc.rust-lang.org/edition-guide/rust-2021/default-cargo-resolver.html) ahora es la versión 2.
- [Adiciones al preludio](https://doc.rust-lang.org/edition-guide/rust-2021/prelude.html) : `TryInto` , `TryFrom` y `FromIterator` ahora están en el alcance de forma predeterminada.
- [Las macros de pánico](https://doc.rust-lang.org/edition-guide/rust-2021/panic-macro-consistency.html) ahora siempre esperan cadenas de formato, al igual que `println!()` .
- [Sintaxis de reserva](https://doc.rust-lang.org/edition-guide/rust-2021/reserving-syntax.html) para `ident#` , `ident"..."` , e `ident'...'` .
- [Advertencias promovidas a errores](https://doc.rust-lang.org/edition-guide/rust-2021/warnings-promoted-to-error.html) : `bare_trait_objects` y `ellipsis_inclusive_range_patterns` .

#### Captura disjunta en cierres

Los cierres capturan automáticamente valores o referencias a identificadores que se usan en el cuerpo, pero antes de 2021, siempre se capturaban como un todo. La nueva función de captura disjunta probablemente simplificará la forma en que escribe los cierres, así que veamos un ejemplo rápido:

```rust
// 2015 or 2018 edition code
let a = SomeStruct::new();

// Move out of one field of the struct
drop(a.x);

// Ok: Still use another field of the struct
println!("{}", a.y);

// Error: Before 2021 edition, tries to capture all of `a`
let c = || println!("{}", a.y);
c();
```

Para solucionar esto, habría tenido que extraer algo como `let y = &a.y;` manualmente antes del cierre para limitar su captura. A partir de Rust 2021, los cierres capturarán automáticamente solo los campos que usan, por lo que el ejemplo anterior se compilará bien.

Este nuevo comportamiento solo se activa en la nueva edición, ya que puede cambiar el orden en que se caen los campos. En cuanto a todos los cambios de edición, está disponible una migración automática, que actualizará sus cierres para los que esto importa insertando `let _ = &a;` dentro del cierre para forzar a toda la estructura a ser capturada como antes.

#### Migrando a 2021

La guía incluye instrucciones de migración para todas las funciones nuevas y, en general, la [transición de un proyecto existente a una nueva edición](https://doc.rust-lang.org/edition-guide/editions/transitioning-an-existing-project-to-a-new-edition.html) . En muchos casos, `cargo fix` puede automatizar los cambios necesarios. ¡Incluso puede encontrar que no se necesitan cambios en su código para 2021!

Por pequeña que parezca esta edición en la superficie, sigue siendo el producto de mucho trabajo duro de muchos colaboradores: ¡vea nuestro registro dedicado [de celebración y agradecimiento](https://github.com/rust-lang/rust/issues/88623) !

### `rust-version` carga

`Cargo.toml` ahora admite un campo [`rust-version`] `[package]` para especificar la versión de Rust mínima admitida para una caja, y Cargo saldrá con un error anticipado si no se cumple. Actualmente, esto no influye en la resolución de dependencias, pero la idea es detectar los problemas de compatibilidad antes de que se conviertan en errores crípticos del compilador.

### Nuevos enlaces en `binding @ pattern`

La coincidencia de patrones de óxido se puede escribir con un único identificador que une el valor completo, seguido de `@` y un patrón estructural más refinado, pero esto no ha permitido enlaces adicionales en ese patrón, ¡hasta ahora!

```rust
struct Matrix {
    data: Vec<f64>,
    row_len: usize,
}

// Before, we need separate statements to bind
// the whole struct and also read its parts.
let matrix = get_matrix();
let row_len = matrix.row_len;
// or with a destructuring pattern:
let Matrix { row_len, .. } = matrix;

// Rust 1.56 now lets you bind both at once!
let matrix @ Matrix { row_len, .. } = get_matrix();
```

En realidad, esto estaba permitido en los días anteriores a Rust 1.0, pero se eliminó debido a [fallas](https://github.com/rust-lang/rust/pull/16053) conocidas en ese momento. Con la evolución del verificador de préstamos desde ese momento, y con pruebas exhaustivas, el equipo compilador determinó que esto era seguro para permitir finalmente Rust estable.

### API estabilizadas

Se estabilizaron los siguientes métodos e implementaciones de rasgos.

- [`std::os::unix::fs::chroot`]
- [`UnsafeCell::raw_get`]
- [`BufWriter::into_parts`]
- [`core::panic::{UnwindSafe, RefUnwindSafe, AssertUnwindSafe}`]
     (anteriormente solo en `std` )
- [`Vec::shrink_to`]
- [`String::shrink_to`]
- [`OsString::shrink_to`]
- [`PathBuf::shrink_to`]
- [`BinaryHeap::shrink_to`]
- [`VecDeque::shrink_to`]
- [`HashMap::shrink_to`]
- [`HashSet::shrink_to`]

Las siguientes funciones previamente estables ahora son `const` .

- [`std::mem::transmute`]
- [`[T]::first`](https://doc.rust-lang.org/stable/std/primitive.slice.html#method.first)
- [`[T]::split_first`](https://doc.rust-lang.org/stable/std/primitive.slice.html#method.split_first)
- [`[T]::last`](https://doc.rust-lang.org/stable/std/primitive.slice.html#method.last)
- [`[T]::split_last`](https://doc.rust-lang.org/stable/std/primitive.slice.html#method.split_last)

### Otros cambios

Hay otros cambios en el lanzamiento de Rust 1.56.0: vea qué cambió en [Rust](https://github.com/rust-lang/rust/blob/master/RELEASES.md#version-1560-2021-10-21) , [Cargo](https://github.com/rust-lang/cargo/blob/master/CHANGELOG.md#cargo-156-2021-10-21) y [Clippy](https://github.com/rust-lang/rust-clippy/blob/master/CHANGELOG.md#rust-156) .

### Contribuyentes a 1.56.0

Mucha gente se unió para crear Rust 1.56.0 y la edición 2021. No podríamos haberlo hecho sin todos ustedes. [¡Gracias!](https://thanks.rust-lang.org/rust/1.56.0/)


[obtener `rustup`]: https://www.rust-lang.org/install.html
[notas detalladas de la versión 1.56.0]: https://github.com/rust-lang/rust/blob/master/RELEASES.md#version-1560-2021-10-21
[`rust-version`]: https://doc.rust-lang.org/cargo/reference/manifest.html#the-rust-version-field
[`std::os::unix::fs::chroot`]: https://doc.rust-lang.org/stable/std/os/unix/fs/fn.chroot.html
[`UnsafeCell::raw_get`]: https://doc.rust-lang.org/stable/std/cell/struct.UnsafeCell.html#method.raw_get
[`BufWriter::into_parts`]: https://doc.rust-lang.org/stable/std/io/struct.BufWriter.html#method.into_parts
[`core::panic::{UnwindSafe, RefUnwindSafe, AssertUnwindSafe}`]: https://github.com/rust-lang/rust/pull/84662
[`Vec::shrink_to`]: https://doc.rust-lang.org/stable/std/vec/struct.Vec.html#method.shrink_to
[`String::shrink_to`]: https://doc.rust-lang.org/stable/std/string/struct.String.html#method.shrink_to
[`OsString::shrink_to`]: https://doc.rust-lang.org/stable/std/ffi/struct.OsString.html#method.shrink_to
[`PathBuf::shrink_to`]: https://doc.rust-lang.org/stable/std/path/struct.PathBuf.html#method.shrink_to
[`BinaryHeap::shrink_to`]: https://doc.rust-lang.org/stable/std/collections/struct.BinaryHeap.html#method.shrink_to
[`VecDeque::shrink_to`]: https://doc.rust-lang.org/stable/std/collections/struct.VecDeque.html#method.shrink_to
[`HashMap::shrink_to`]: https://doc.rust-lang.org/stable/std/collections/hash_map/struct.HashMap.html#method.shrink_to
[`HashSet::shrink_to`]: https://doc.rust-lang.org/stable/std/collections/hash_set/struct.HashSet.html#method.shrink_to
[`std::mem::transmute`]: https://doc.rust-lang.org/stable/std/mem/fn.transmute.html